
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>sdt_assignment</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-10-13"><meta name="DC.source" content="sdt_assignment.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Q1a)</a></li><li><a href="#3">variable duration and constant contrast</a></li><li><a href="#8">constant duration and variable contrast</a></li><li><a href="#13">Q1b)</a></li><li><a href="#16">Q2</a></li><li><a href="#20">Simulation for AFC</a></li><li><a href="#38">Theoretical for AFC</a></li><li><a href="#39">Function to run AFC_experiment</a></li><li><a href="#40">Simulation for RT</a></li><li><a href="#48">Function to run reaction-time experiment</a></li><li><a href="#49">Function to create plots</a></li></ul></div><pre class="codeinput">clear; close <span class="string">all</span>; clc;
</pre><h2 id="2">Q1a)</h2><h2 id="3">variable duration and constant contrast</h2><p>Setting up the constants: stimulus_duration varies between 0.1 s to 2 s, lets say there are 10000 trials per experiment, the contrast is given to be 0.2, the variance of both the distributions is 1, and A and B are equally likely to pA = 0.5</p><pre class="codeinput">stim_dur = 0.1: 0.1: 2;
trials_per_experiment = 10000;
contrast = 0.2;
var_dist = 1;
pA = 0.5;
</pre><p>Next, arrays that will hold simulated percentage correct, simulated dprime, theoretical percentage correct, and theoretical dprime are initialized. The critical value is not given so lets initialize it to None, this will make use of the optimal criterion.</p><pre class="codeinput">percentage_correct_simul = zeros(size(stim_dur));
dprime_simul = zeros(size(stim_dur));
percentage_correct_theor = zeros(size(stim_dur));
dprime_theor = zeros(size(stim_dur));
crit = 10000;
</pre><p>For each stim_duration, run the experiment AFC_experiment. Here the optimal criterion is expected to be zero as that is where the two distributions will overlap given that their means are +2*c*time_steps and -2*c*time_steps and that they have the same standard deviation.</p><pre class="codeinput"><span class="keyword">for</span> i = 1:length(stim_dur)
    dur = stim_dur(i);
    [optim_criterion, pcorr_simul, dp_simul, pcorr_theor, dp_theor] = <span class="keyword">...</span>
        AFC_experiment(dur, contrast, var_dist,<span class="keyword">...</span>
        pA, trials_per_experiment, crit);
    <span class="keyword">if</span> i == 1
        disp([<span class="string">'The optimum criterion is: '</span>, num2str(optim_criterion)])
    <span class="keyword">end</span>
    percentage_correct_simul(i) = pcorr_simul;
    dprime_simul(i) = dp_simul;
    percentage_correct_theor(i) = pcorr_theor;
    dprime_theor(i) = dp_theor;
<span class="keyword">end</span>

figure(1);
xlab = <span class="string">'Duration of stimulus (s)'</span>;
plot_figs(stim_dur, percentage_correct_simul, dprime_simul, percentage_correct_theor, <span class="keyword">...</span>
    dprime_theor, xlab)
</pre><img vspace="5" hspace="5" src="sdt_assignment_01.png" alt=""> <p>From the graphs, we can see that the theoretical predictions match the simulations. Specifically we see that the percentage correct increases monotonically as the stimulus duration increases as this allows the subject to accumulate more evidence and hence respond correctly more often. This is the psychometric function and it begins saturating as the stimulus duration increase does not have as much impact on the performance after a certain threshold.</p><p>d' is the sensitivity of the stimulus and it increases with the duration as the evidence accumulated increases. This is because each evidence comes from a normal distribution of mean 2*c for A and -2*c for B. As duration of the stimulus increases, the timesteps in which the evidence is accumulated increases and the resulting evidence now comes from a normal distribution of mean 2*c*time_steps for A and -2*c*time_steps for B. Therefore, the two distributions get further and further apart thereby increasing the d'.</p><h2 id="8">constant duration and variable contrast</h2><p>Setting up the constants: duration of stimulus is now constant at 0.2 s, lets say there are 10000 trials per experiment, the contrast varies between 0.05 and 1. The variance of both the distributions is 1, and A and B are equally likely to pA = 0.5</p><pre class="codeinput">dur = 0.2;
stim_contrast = 0.05: 0.05: 1;
pA = 0.5;
</pre><p>Next, arrays that will hold simulated percentage correct, simulated dprime, theoretical percentage correct, and theoretical dprime are initialized. The critical value is not given so lets initialize it to None, this will make use of the optimal criterion.</p><pre class="codeinput">percentage_correct_simul = zeros(size(stim_contrast));
dprime_simul = zeros(size(stim_contrast));
percentage_correct_theor = zeros(size(stim_contrast));
dprime_theor = zeros(size(stim_contrast));
</pre><p>For each stim_contrast, run the experiment AFC_experiment. Here the optimal criterion is expected to be zero as that is where the two distributions will overlap given that their means are +2*c*time_steps and -2*c*time_steps and that they have the same standard deviation.</p><pre class="codeinput"><span class="keyword">for</span> i = 1:length(stim_contrast)
    contrast = stim_contrast(i);
    [optim_criterion, pcorr_simul, dp_simul, pcorr_theor, dp_theor] = <span class="keyword">...</span>
        AFC_experiment(dur, contrast, var_dist,<span class="keyword">...</span>
        pA, trials_per_experiment, crit);
    <span class="keyword">if</span> i == 1
        disp([<span class="string">'The optimum criterion is: '</span>, num2str(optim_criterion)])
    <span class="keyword">end</span>
    percentage_correct_simul(i) = pcorr_simul;
    dprime_simul(i) = dp_simul;
    percentage_correct_theor(i) = pcorr_theor;
    dprime_theor(i) = dp_theor;
<span class="keyword">end</span>

figure(2);
xlab = <span class="string">'Contrast of stimulus (s)'</span>;
plot_figs(stim_contrast, percentage_correct_simul, dprime_simul, percentage_correct_theor, <span class="keyword">...</span>
    dprime_theor, xlab)
</pre><pre class="codeoutput">The optimum criterion is: 0
</pre><img vspace="5" hspace="5" src="sdt_assignment_02.png" alt=""> <p>From the graphs, we can see that the theoretical predictions match the simulations. Specifically we see that the percentage correct increases monotonically as the stimulus contrast increases as this allows the subject to better distinguish the stimulus from noise and hence respond correctly more often. This is the psychometric function and it begins saturating as the stimulus contrast increase does not have as much impact on the performance after a certain threshold.</p><p>d' is the sensitivity of the stimulus and it increases with the contrast increases. This is because the evidence for a given trials comes from a normal distribution of mean 2*c for A and -2*c for B. As contrast of the stimulus increases, the means of A and B increase further apart. Therefore, the two distributions get further and further apart thereby increasing the d'.</p><h2 id="13">Q1b)</h2><p>Setting up the constants: duration of stimulus is now constant at 0.4 s, lets say there are 100 trials per experiment, the contrast is constant at 0.1. The variance of both the distributions is 1, and A and B are equally likely to pA = 0.75</p><pre class="codeinput">dur = 0.4;
trials_per_experiment = 100;
contrast = 0.1;
var_dist = 1;
pA = 0.75;
</pre><p>Running the AFC experiment to compute the optimum criterion, percentage correct simulated, dp simulated. Ignore the theoretical predictions here.</p><pre class="codeinput">[optim_criterion, pcorr_simul_optim, dp_simul_optim, pcorr_theor_optim, dp_theor_optim] = <span class="keyword">...</span>
    AFC_experiment(dur, contrast, var_dist,<span class="keyword">...</span>
    pA, trials_per_experiment, crit);
disp([<span class="string">'The optimum criterion is: '</span>, num2str(optim_criterion)])
performance_summary = [optim_criterion, pcorr_simul_optim, dp_simul_optim];

crit = 0;
[optim_criterion_0, pcorr_simul_0, dp_simul_0, pcorr_theor_0, dp_theor_0] = <span class="keyword">...</span>
    AFC_experiment(dur, contrast, var_dist,<span class="keyword">...</span>
    pA, trials_per_experiment, crit);
performance_summary = [performance_summary; <span class="keyword">...</span>
    crit, pcorr_simul_0, dp_simul_0];

ColNames = {<span class="string">'Criterion'</span>, <span class="string">'pcorrect_simulation'</span>, <span class="string">'dp_simulation'</span>};
T = table(performance_summary(:, 1), performance_summary(:, 2), <span class="keyword">...</span>
    performance_summary(:, 3), <span class="keyword">...</span>
    <span class="string">'VariableNames'</span>, ColNames);
disp(T)
</pre><pre class="codeoutput">The optimum criterion is: -2.7465
    Criterion    pcorrect_simulation    dp_simulation
    _________    ___________________    _____________

     -2.7465             79                0.39875   
           0             65                0.92488   

</pre><p>From the table we can see that the percentage correct is higher in case of the optimal criterion and the simulated dprime is also higher. This is because the optimal criterion is the one that maximizes the performance.</p><h2 id="16">Q2</h2><p>Initiliazing the constants</p><pre class="codeinput">dur = 2;
trials_per_experiment = 100;
stim_contrast = [0.1 0.5];
var_dist = 1;
crit = 10000;
pA = 0.5;
</pre><p>The lower bounds are taken to be -1 (near bound) and -5 (farther bound). Similarly the upper bounds are taken to be 1 (near bound) and 5 (farther bound). The RT experiment is run for each pair of contrast, ub, and lb, and the performance metrics are summarized.</p><pre class="codeinput">lower_bounds = [-1, -5];
upper_bounds = [1, 5];
output = zeros(1, 9);
<span class="keyword">for</span> contrast = stim_contrast
    <span class="keyword">for</span> lb = lower_bounds
        <span class="keyword">for</span> ub = upper_bounds
            [optim_criterion, Hrate, FArate, rtime] = <span class="keyword">...</span>
                RT_experiment(dur, contrast, var_dist,<span class="keyword">...</span>
                pA, trials_per_experiment, crit, lb, ub);

            output = [output; contrast, lb, ub, Hrate, FArate, median(rtime, 1),<span class="keyword">...</span>
                var(rtime, 1), min(rtime), max(rtime)];
        <span class="keyword">end</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
output = output(2:end, :);
ColNames = {<span class="string">'Contrast'</span>, <span class="string">'LowerBound'</span>, <span class="string">'UpperBound'</span>, <span class="string">'Hitrate'</span>, <span class="string">'FArate'</span>,<span class="keyword">...</span>
    <span class="string">'rtime_median'</span>, <span class="string">'rtime_var'</span>, <span class="string">'rtime_min'</span>, <span class="string">'rtime_max'</span>};
T = table(output(:, 1), output(:, 2), output(:, 3), output(:, 4), <span class="keyword">...</span>
    output(:, 5), output(:, 6), output(:, 7), output(:, 8), <span class="keyword">...</span>
    output(:, 9), <span class="string">'VariableNames'</span>, ColNames);
disp(T)
</pre><p>From the table we can see that as the contrast of the stimulus increases, the reaction time decreases. The hit rate is determined by the upper bound, the lower is the upper bound and the higher is the contrast, higher is the hit rate. The false alarm rate is determined by the lower bound. The lower is the bound, the further away is the lower bound, the higher is the false alarm rate.</p><p>The symmetric bounds that are closer account for quick response but higher errors. And the symmetric bounds that are farther away account for slower response but have a much better performance with higher hit rate and almost 0 false alarm rate. The asymmetric bounds hamper either the hit rate or the false alarm rate.</p><pre class="codeinput"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</pre><h2 id="20">Simulation for AFC</h2><p>The trials in the experiment are simulated as +1 for stimulus A and -1 for stimulus B, the probabilities of the stimuli are determined by pA, and the length of the experiment is determined by t_length</p><p>The time_steps variable stores the number of time_steps each of 100 ms in which the evidence will be stored. The mean and variance of the new distribution is then just a sum of the old distributions over the time_steps</p><p>The optimum criterion (x) is when the two distributions overlap. This happens when the posterior probabilities of the two distributions are the same i.e. when p(A|x)/p(B|x) = 1. Using Bayesian probabilities, we have:</p><p><img src="sdt_assignment_eq13315470166255836792.png" alt="$$\frac{p(A|x)}{(p(B|x)} = \frac{p(x|A)}{(p(x|B)}\frac{p(A)}{(p(B)}&#xA;$$" style="width:121px;height:26px;"></p><p>Therefore, for optimum criterion, we have:</p><p><img src="sdt_assignment_eq06121127408821892229.png" alt="$$1 = \frac{p(x|A)}{(p(x|B)}\frac{p(A)}{(p(B)} $$" style="width:88px;height:26px;"></p><p><img src="sdt_assignment_eq17967081746198349257.png" alt="$$\frac{p(x|A)}{(p(x|B)} = \frac{p(B)}{(p(A)} $$" style="width:81px;height:26px;"></p><p>Using the definition of Gaussian probabilty, we get: <img src="sdt_assignment_eq08782447002197187271.png" alt="$$\frac{e^{-\frac{(x-\bar{A})^2}{2\sigma_A^2}}}{e^{-\frac{(x-\bar{B})^2}{2\sigma_B^2}}} = \frac{p(B)}{(p(A)} $$" style="width:78px;height:43px;"></p><p>Taking log on both sides: <img src="sdt_assignment_eq10093651352239430298.png" alt="$$-\frac{(x-\bar{A})^2}{2\sigma_A^2} -\frac{(x-\bar{B})^2}{2\sigma_B^2} = log(\frac{p(B)}{(p(A)}) $$" style="width:175px;height:28px;"></p><p>Since the variance of A and B are the same and the mean of B = - mean of A, we can write:</p><p><img src="sdt_assignment_eq11581974344176742571.png" alt="$$ -\frac{(x-\bar{A})^2 +(x+\bar{A})^2}{2\sigma_A^2} = log(\frac{p(B)}{(p(A)}) $$" style="width:172px;height:28px;"></p><p>Solving for x, we get:</p><p><img src="sdt_assignment_eq03534402838875758802.png" alt="$$x =\frac{\sigma_A^2}{2\bar{A}} log(\frac{p(B)}{(p(A)}) $$" style="width:89px;height:27px;"></p><p>This is the optimal criterion. The evidence is computed as a sample from a normal distribution with mean = 2*contrast*time_steps, and var = A_var.</p><p>The response is a matrix that is 1 if evidence is greater than the criterion and -1 if evidence is less than the criterion.</p><p>This is followed by the computation of Hits (H), Misses (M), False alarms (FA) and correct rejections (CR).</p><p>Percentage correct trials in the simulation is the ratio of hits + correct rejections to the total number of trials in the experiment multiplied by 100.</p><p>The dprime from simulation is given as dprime_simul = zH - zFA where z is the z-score associated with the Hitrate and the false alarm rate, respectively.</p><h2 id="38">Theoretical for AFC</h2><p>The theoretical percentage correct is the sum of the product of the cumulative distribution of noise (B) and the probability density function of signal (A). The theoretical dprime is the ratio of the difference between the means of the two distributions and the standard deviation of the distributions.</p><h2 id="39">Function to run AFC_experiment</h2><pre class="codeinput"><span class="keyword">function</span> [optim_criterion, pcorr_simul, dp_simul, pcorr_theor, dp_theor] = <span class="keyword">...</span>
    AFC_experiment(dur, contrast, var_dist, pA, t_length, crit)

    <span class="comment">% Simulation</span>
    trials = rand(t_length, 1);
    trials = (trials&gt;(1-pA)) -1 * (trials&lt;=(1-pA));

    time_steps = dur * 10;
    B_mean = -2 * time_steps * contrast;
    A_mean = 2 * time_steps * contrast;
    B_var = time_steps * var_dist;
    A_var = time_steps * var_dist;

    prior_odds = pA/(1-pA);
    optim_criterion = A_var/(2*A_mean) * log(1/prior_odds);

    <span class="keyword">if</span> crit == 10000
        crit = optim_criterion;
    <span class="keyword">end</span>

    evidence = time_steps * 2 * contrast * trials + <span class="keyword">...</span>
        sqrt(A_var) * trials .* randn(t_length, 1);
    response = (evidence &gt; crit) -1 * (evidence &lt;= crit);

    H = 0; M = 0; CR = 0; FA = 0;
    <span class="keyword">for</span> i = 1:t_length
        <span class="keyword">if</span> trials(i) == 1
            <span class="keyword">if</span> response(i) == 1
                H = H + 1;
            <span class="keyword">else</span>
                M = M + 1;
            <span class="keyword">end</span>
        <span class="keyword">else</span>
            <span class="keyword">if</span> response(i) == -1
                CR = CR + 1;
            <span class="keyword">else</span>
                FA = FA + 1;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    pcorr_simul = (H + CR) * 100/t_length;

    Hrate = H/(H+M);
    FArate = FA/(FA+CR);
    <span class="keyword">if</span> Hrate == 1
        Hrate = 0.9999;
    <span class="keyword">end</span>
    <span class="keyword">if</span> FArate == 0
        FArate = 0.0001;
    <span class="keyword">end</span>
    zH = -sqrt(2) * erfcinv(2*Hrate);
    zFA = -sqrt(2) * erfcinv(2*FArate);
    dp_simul = zH - zFA;

    <span class="comment">% Theoretical</span>
    resp_range = B_mean-3*B_var: 0.01: A_mean+3*A_var;
    B_cdf = normcdf(resp_range, B_mean, sqrt(B_var));
    A_pdf = normpdf(resp_range, A_mean, sqrt(A_var));
    pcorr_theor = sum(A_pdf .* B_cdf);
    dp_theor = (A_mean - B_mean)/sqrt(A_var);
<span class="keyword">end</span>
</pre><pre class="codeoutput">The optimum criterion is: 0
</pre><h2 id="40">Simulation for RT</h2><p>The trials in the experiment are simulated as +1 for stimulus A and -1 for stimulus B, the probabilities of the stimuli are determined by pA, and the length of the experiment is determined by t_length. The responses and reaction times are initialized as zeros.</p><p>The time_steps variable stores the number of time_steps each of 100 ms in which the evidence will be stored. The mean and variance of the new distribution is then just a sum of the old distributions over the time_steps</p><p>The optimum criterion (x) is computed as in AFC. For each trial, the log_posteriors is computed from the log_priors which is log(p(A)/p(B)) and updated by the evidence at each time-step given by the log-likelihood ratio:</p><p><img src="sdt_assignment_eq05484157104765357828.png" alt="$$Log\ Likelihood\ ratio = log(\frac{p(evidence|A)}{p(evidence|B)}) $$" style="width:210px;height:26px;"></p><p>The update log posteriors is then: log_posteriors = log_likelihood_ratio + log_priors.</p><p>At time step 0, log_posteriors = log_priors = 0 for the case p(A) = p(B).</p><p>The trial runs until the log_posteriors hit either the upper bound or the lower bound which determines the response as either +1 (A) or -1 (B). The reaction time is the length of log_posteriors - 1.</p><p>The trials and response vectors are then compared to determine the hit rate and the false alarm rate.</p><h2 id="48">Function to run reaction-time experiment</h2><pre class="codeinput"><span class="keyword">function</span> [optim_criterion, Hrate, FArate, rtime] = <span class="keyword">...</span>
    RT_experiment(dur, contrast, var_dist, pA, t_length, crit, lb, ub)
    trials = rand(t_length, 1);
    trials = (trials&gt;(1-pA)) -1 * (trials&lt;=(1-pA));
    response = zeros(t_length, 1);
    rtime = zeros(t_length, 1);

    <span class="comment">% Simulation</span>
    time_steps = dur * 10;
    B_mean = -2 * time_steps * contrast;
    A_mean = 2 * time_steps * contrast;
    B_var = time_steps * var_dist;
    A_var = time_steps * var_dist;
    prior_odds = pA/(1-pA);
    optim_criterion = A_var/(2*A_mean) * log(1/prior_odds);

    <span class="keyword">if</span> crit == 10000
        crit = optim_criterion;
    <span class="keyword">end</span>

    log_priors = log(prior_odds);

    <span class="keyword">for</span> trial_count = 1:t_length
        trial = trials(trial_count);
        log_posteriors = log_priors;
        <span class="keyword">while</span> (lb &lt; log_posteriors(end)) &amp; (log_posteriors(end) &lt; ub)
            evidence = 2 * contrast * trial + <span class="keyword">...</span>
                trial * randn();
            evidence_A = normpdf(evidence, A_mean, sqrt(A_var));
            evidence_B = normpdf(evidence, B_mean, sqrt(B_var));
            updated_posterior = log_posteriors(end) + <span class="keyword">...</span>
                log(evidence_A/evidence_B);
            log_posteriors = [log_posteriors, updated_posterior];
        <span class="keyword">end</span>
        response(trial_count) = (log_posteriors(end) &gt;= ub) -1 * (log_posteriors(end) &lt;= lb);

        rtime(trial_count) = length(log_posteriors) - 1;
        <span class="keyword">if</span> trial_count == 10
            figure();
            plot(0:rtime(trial_count), log_posteriors, <span class="string">'LineWidth'</span>, 1.5, <span class="keyword">...</span>
                <span class="string">'DisplayName'</span>, <span class="string">'rt'</span>)
            hold <span class="string">on</span>;
            plot(xlim, [ub, ub], <span class="string">'k'</span>, <span class="string">'LineWidth'</span>, 2, <span class="string">'DisplayName'</span>, <span class="keyword">...</span>
                <span class="string">'upper bound'</span>)
            plot(xlim, [lb, lb], <span class="string">'k'</span>, <span class="string">'LineWidth'</span>, 2, <span class="string">'DisplayName'</span>, <span class="keyword">...</span>
                <span class="string">'lower bound'</span>)
            xlabel(<span class="string">'Time steps (100 ms)'</span>)
            ylabel(<span class="string">'$$log(\frac{p(A|evidence)}{p(B|evidence)})$$'</span>, <span class="string">'Interpreter'</span>, <span class="string">'latex'</span>)
            title([<span class="string">'Drift-diffusion model: '</span>, <span class="string">'contrast: '</span>, num2str(contrast),<span class="keyword">...</span>
                <span class="string">' stimulus: '</span>, num2str(trials(trial_count)),<span class="keyword">...</span>
                <span class="string">', response: '</span>, num2str(response(trial_count))])
            legend()
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    H = 0; M = 0; CR = 0; FA = 0;
    <span class="keyword">for</span> i = 1:t_length
        <span class="keyword">if</span> trials(i) == 1
            <span class="keyword">if</span> response(i) == 1
                H = H + 1;
            <span class="keyword">else</span>
                M = M + 1;
            <span class="keyword">end</span>
        <span class="keyword">else</span>
            <span class="keyword">if</span> response(i) == -1
                CR = CR + 1;
            <span class="keyword">else</span>
                FA = FA + 1;
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    Hrate = H/(H+M);
    FArate = FA/(FA+CR);
<span class="keyword">end</span>
</pre><pre class="codeoutput">    Contrast    LowerBound    UpperBound    Hitrate     FArate     rtime_median    rtime_var    rtime_min    rtime_max
    ________    __________    __________    _______    ________    ____________    _________    _________    _________

      0.1           -1            1            0.75     0.23077           7         43.542          2            34   
      0.1           -1            5         0.68889           0          15          527.9          1           110   
      0.1           -5            1               1     0.36735          16         578.74          2           111   
      0.1           -5            5         0.97872           0        54.5         2132.7         17           309   
      0.5           -1            1         0.90909    0.088889           1         0.2976          1             4   
      0.5           -1            5         0.91837           0           2         2.9696          1             9   
      0.5           -5            1               1    0.098039           2         2.1076          1             8   
      0.5           -5            5               1    0.017544           3           2.78          1            10   

</pre><img vspace="5" hspace="5" src="sdt_assignment_03.png" alt=""> <img vspace="5" hspace="5" src="sdt_assignment_04.png" alt=""> <img vspace="5" hspace="5" src="sdt_assignment_05.png" alt=""> <img vspace="5" hspace="5" src="sdt_assignment_06.png" alt=""> <img vspace="5" hspace="5" src="sdt_assignment_07.png" alt=""> <img vspace="5" hspace="5" src="sdt_assignment_08.png" alt=""> <img vspace="5" hspace="5" src="sdt_assignment_09.png" alt=""> <img vspace="5" hspace="5" src="sdt_assignment_10.png" alt=""> <h2 id="49">Function to create plots</h2><pre class="codeinput"><span class="keyword">function</span> plot_figs(x, y1, y2, y3, y4, xlab)
    subplot(2, 2, 1)
    plot(x, y1, <span class="string">'b-o'</span>, <span class="string">'LineWidth'</span>, 2, <span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>, 5)
    xlabel(xlab)
    ylabel(<span class="string">'Percentage correct'</span>)
    title(<span class="string">'Psychometric function simulation'</span>)
    subplot(2, 2,2)
    plot(x, y2, <span class="string">'m-o'</span>, <span class="string">'LineWidth'</span>, 2, <span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>, 5);
    xlabel(xlab)
    ylabel(<span class="string">"d'"</span>)
    title(<span class="string">"d' simulation"</span>)

    subplot(2, 2, 3)
    plot(x, y3, <span class="string">'b-o'</span>, <span class="string">'LineWidth'</span>, 2, <span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>, 5)
    xlabel(xlab)
    ylabel(<span class="string">'Percentage correct'</span>)
    title(<span class="string">'Psychometric function theoretical'</span>)
    subplot(2, 2, 4)
    plot(x, y4, <span class="string">'m-o'</span>, <span class="string">'LineWidth'</span>, 2, <span class="keyword">...</span>
        <span class="string">'MarkerSize'</span>, 5);
    xlabel(xlab)
    ylabel(<span class="string">"d'"</span>)
    title(<span class="string">"d' theoretical"</span>)
<span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
clear; close all; clc;

%% Q1a)
%% variable duration and constant contrast
% Setting up the constants: stimulus_duration varies between 0.1 s to 2 s,
% lets say there are 10000 trials per experiment, the contrast is given to
% be 0.2, the variance of both the distributions is 1, and A and B are
% equally likely to pA = 0.5
stim_dur = 0.1: 0.1: 2;
trials_per_experiment = 10000;
contrast = 0.2;
var_dist = 1;
pA = 0.5;

%%
% Next, arrays that will hold simulated percentage correct, simulated
% dprime, theoretical percentage correct, and theoretical dprime are
% initialized. The critical value is not given so lets initialize it to
% None, this will make use of the optimal criterion.

percentage_correct_simul = zeros(size(stim_dur));
dprime_simul = zeros(size(stim_dur));
percentage_correct_theor = zeros(size(stim_dur));
dprime_theor = zeros(size(stim_dur));
crit = 10000;

%%
% For each stim_duration, run the experiment AFC_experiment. Here the
% optimal criterion is expected to be zero as that is where the two
% distributions will overlap given that their means are +2*c*time_steps and
% -2*c*time_steps and that they have the same standard deviation.
for i = 1:length(stim_dur)
    dur = stim_dur(i);
    [optim_criterion, pcorr_simul, dp_simul, pcorr_theor, dp_theor] = ...
        AFC_experiment(dur, contrast, var_dist,...
        pA, trials_per_experiment, crit);
    if i == 1
        disp(['The optimum criterion is: ', num2str(optim_criterion)])
    end
    percentage_correct_simul(i) = pcorr_simul;
    dprime_simul(i) = dp_simul;
    percentage_correct_theor(i) = pcorr_theor;
    dprime_theor(i) = dp_theor;
end

figure(1);
xlab = 'Duration of stimulus (s)';
plot_figs(stim_dur, percentage_correct_simul, dprime_simul, percentage_correct_theor, ...
    dprime_theor, xlab)

%%
% From the graphs, we can see that the theoretical predictions match the
% simulations. Specifically we see that the percentage correct increases
% monotonically as the stimulus duration increases as this allows the
% subject to accumulate more evidence and hence respond correctly more
% often. This is the psychometric function and it begins saturating as the
% stimulus duration increase does not have as much impact on the
% performance after a certain threshold.
%%
% d' is the sensitivity of the stimulus and it increases with the duration
% as the evidence accumulated increases. This is because each evidence
% comes from a normal distribution of mean 2*c for A and -2*c for B. As
% duration of the stimulus increases, the timesteps in which the evidence
% is accumulated increases and the resulting evidence now comes from a
% normal distribution of mean 2*c*time_steps for A and -2*c*time_steps for
% B. Therefore, the two distributions get further and further apart thereby
% increasing the d'.

%% constant duration and variable contrast
% Setting up the constants: duration of stimulus is now constant at 0.2 s,
% lets say there are 10000 trials per experiment, the contrast varies
% between 0.05 and 1. The variance of both the distributions is 1, and A and B are
% equally likely to pA = 0.5
dur = 0.2;
stim_contrast = 0.05: 0.05: 1;
pA = 0.5;
%%
% Next, arrays that will hold simulated percentage correct, simulated
% dprime, theoretical percentage correct, and theoretical dprime are
% initialized. The critical value is not given so lets initialize it to
% None, this will make use of the optimal criterion.
percentage_correct_simul = zeros(size(stim_contrast));
dprime_simul = zeros(size(stim_contrast));
percentage_correct_theor = zeros(size(stim_contrast));
dprime_theor = zeros(size(stim_contrast));
%%
% For each stim_contrast, run the experiment AFC_experiment. Here the
% optimal criterion is expected to be zero as that is where the two
% distributions will overlap given that their means are +2*c*time_steps and
% -2*c*time_steps and that they have the same standard deviation.
for i = 1:length(stim_contrast)
    contrast = stim_contrast(i);
    [optim_criterion, pcorr_simul, dp_simul, pcorr_theor, dp_theor] = ...
        AFC_experiment(dur, contrast, var_dist,...
        pA, trials_per_experiment, crit);
    if i == 1
        disp(['The optimum criterion is: ', num2str(optim_criterion)])
    end
    percentage_correct_simul(i) = pcorr_simul;
    dprime_simul(i) = dp_simul;
    percentage_correct_theor(i) = pcorr_theor;
    dprime_theor(i) = dp_theor;
end

figure(2);
xlab = 'Contrast of stimulus (s)';
plot_figs(stim_contrast, percentage_correct_simul, dprime_simul, percentage_correct_theor, ...
    dprime_theor, xlab)
%%
% From the graphs, we can see that the theoretical predictions match the
% simulations. Specifically we see that the percentage correct increases
% monotonically as the stimulus contrast increases as this allows the
% subject to better distinguish the stimulus from noise and hence respond correctly more
% often. This is the psychometric function and it begins saturating as the
% stimulus contrast increase does not have as much impact on the
% performance after a certain threshold.
%%
% d' is the sensitivity of the stimulus and it increases with the contrast increases. 
% This is because the evidence for a given trials
% comes from a normal distribution of mean 2*c for A and -2*c for B. As
% contrast of the stimulus increases, the means of A and B increase further apart.
% Therefore, the two distributions get further and further apart thereby
% increasing the d'.

%% Q1b)
% Setting up the constants: duration of stimulus is now constant at 0.4 s,
% lets say there are 100 trials per experiment, the contrast is constant at
% 0.1.
% The variance of both the distributions is 1, and A and B are
% equally likely to pA = 0.75
dur = 0.4;
trials_per_experiment = 100;
contrast = 0.1;
var_dist = 1;
pA = 0.75;

%%
% Running the AFC experiment to compute the optimum criterion, percentage
% correct simulated, dp simulated. Ignore the theoretical predictions here.
[optim_criterion, pcorr_simul_optim, dp_simul_optim, pcorr_theor_optim, dp_theor_optim] = ...
    AFC_experiment(dur, contrast, var_dist,...
    pA, trials_per_experiment, crit);
disp(['The optimum criterion is: ', num2str(optim_criterion)])
performance_summary = [optim_criterion, pcorr_simul_optim, dp_simul_optim];

crit = 0;
[optim_criterion_0, pcorr_simul_0, dp_simul_0, pcorr_theor_0, dp_theor_0] = ...
    AFC_experiment(dur, contrast, var_dist,...
    pA, trials_per_experiment, crit);
performance_summary = [performance_summary; ...
    crit, pcorr_simul_0, dp_simul_0];

ColNames = {'Criterion', 'pcorrect_simulation', 'dp_simulation'};
T = table(performance_summary(:, 1), performance_summary(:, 2), ...
    performance_summary(:, 3), ...
    'VariableNames', ColNames);
disp(T)
%%
% From the table we can see that the percentage correct is higher in case
% of the optimal criterion and the simulated dprime is also higher. This is
% because the optimal criterion is the one that maximizes the performance.

%% Q2
% Initiliazing the constants
dur = 2;
trials_per_experiment = 100;
stim_contrast = [0.1 0.5];
var_dist = 1;
crit = 10000;
pA = 0.5;

%%
% The lower bounds are taken to be -1 (near bound) and -5 (farther bound).
% Similarly the upper bounds are taken to be 1 (near bound) and 5 (farther
% bound). The RT experiment is run for each pair of contrast, ub, and lb,
% and the performance metrics are summarized.
lower_bounds = [-1, -5];
upper_bounds = [1, 5];
output = zeros(1, 9);
for contrast = stim_contrast      
    for lb = lower_bounds
        for ub = upper_bounds
            [optim_criterion, Hrate, FArate, rtime] = ...
                RT_experiment(dur, contrast, var_dist,...
                pA, trials_per_experiment, crit, lb, ub);
            
            output = [output; contrast, lb, ub, Hrate, FArate, median(rtime, 1),...
                var(rtime, 1), min(rtime), max(rtime)];
        end
    end
end
output = output(2:end, :);
ColNames = {'Contrast', 'LowerBound', 'UpperBound', 'Hitrate', 'FArate',...
    'rtime_median', 'rtime_var', 'rtime_min', 'rtime_max'};
T = table(output(:, 1), output(:, 2), output(:, 3), output(:, 4), ...
    output(:, 5), output(:, 6), output(:, 7), output(:, 8), ...
    output(:, 9), 'VariableNames', ColNames);
disp(T)
%%
% From the table we can see that as the contrast of the stimulus increases,
% the reaction time decreases. The hit rate is determined by the upper
% bound, the lower is the upper bound and the higher is the contrast,
% higher is the hit rate. The false alarm rate is determined by the lower
% bound. The lower is the bound, the further away is the lower bound, the
% higher is the false alarm rate.
%%
% The symmetric bounds that are closer account for quick response but
% higher errors. And the symmetric bounds that are farther away account for
% slower response but have a much better performance with higher hit rate
% and almost 0 false alarm rate. The asymmetric bounds hamper either the
% hit rate or the false alarm rate.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Simulation for AFC
% The trials in the experiment are simulated as +1 for stimulus A and
% -1 for stimulus B, the probabilities of the stimuli are determined by
% pA, and the length of the experiment is determined by t_length
%%
% The time_steps variable stores the number of time_steps each of 100
% ms in which the evidence will be stored. The mean and variance of the
% new distribution is then just a sum of the old distributions over the
% time_steps
%%
% The optimum criterion (x) is when the two distributions overlap. This
% happens when the posterior probabilities of the two distributions are
% the same i.e. when p(A|x)/p(B|x) = 1. Using Bayesian probabilities, we
% have:
%%
% $$\frac{p(A|x)}{(p(B|x)} = \frac{p(x|A)}{(p(x|B)}\frac{p(A)}{(p(B)}
% $$
%%
% Therefore, for optimum criterion, we have:
%%
% $$1 = \frac{p(x|A)}{(p(x|B)}\frac{p(A)}{(p(B)} $$
%%
% $$\frac{p(x|A)}{(p(x|B)} = \frac{p(B)}{(p(A)} $$
%%
% Using the definition of Gaussian probabilty, we get:
% $$\frac{e^{-\frac{(x-\bar{A})^2}{2\sigma_A^2}}}{e^{-\frac{(x-\bar{B})^2}{2\sigma_B^2}}} = \frac{p(B)}{(p(A)} $$
%%
% Taking log on both sides:
% $$-\frac{(x-\bar{A})^2}{2\sigma_A^2} -\frac{(x-\bar{B})^2}{2\sigma_B^2} = log(\frac{p(B)}{(p(A)}) $$
%%
% Since the variance of A and B are the same and the mean of B = - mean of
% A, we can write:
%%
% $$ -\frac{(x-\bar{A})^2 +(x+\bar{A})^2}{2\sigma_A^2} = log(\frac{p(B)}{(p(A)}) $$
%%
% Solving for x, we get:
%%
% $$x =\frac{\sigma_A^2}{2\bar{A}} log(\frac{p(B)}{(p(A)}) $$
%%
% This is the optimal criterion. The evidence is computed as a sample from
% a normal distribution with mean = 2*contrast*time_steps, and var = A_var.
%%
% The response is a matrix that is 1 if evidence is greater than the
% criterion and -1 if evidence is less than the criterion.
%%
% This is followed by the computation of Hits (H), Misses (M), False
% alarms (FA) and correct rejections (CR).
%%
% Percentage correct trials in the simulation is the ratio of hits +
% correct rejections to the total number of trials in the experiment
% multiplied by 100.
%%
% The dprime from simulation is given as dprime_simul = zH - zFA where z is
% the z-score associated with the Hitrate and the false alarm rate,
% respectively.
%% Theoretical for AFC
% The theoretical percentage correct is the sum of the product of the cumulative
% distribution of noise (B) and the probability density function of signal
% (A). The theoretical dprime is the ratio of the difference between the
% means of the two distributions and the standard deviation of the
% distributions.
%% Function to run AFC_experiment
function [optim_criterion, pcorr_simul, dp_simul, pcorr_theor, dp_theor] = ...
    AFC_experiment(dur, contrast, var_dist, pA, t_length, crit)
    
    % Simulation
    trials = rand(t_length, 1);
    trials = (trials>(1-pA)) -1 * (trials<=(1-pA));
    
    time_steps = dur * 10;
    B_mean = -2 * time_steps * contrast;
    A_mean = 2 * time_steps * contrast;
    B_var = time_steps * var_dist;
    A_var = time_steps * var_dist;
    
    prior_odds = pA/(1-pA);                                                                                                          
    optim_criterion = A_var/(2*A_mean) * log(1/prior_odds);
    
    if crit == 10000
        crit = optim_criterion;
    end
    
    evidence = time_steps * 2 * contrast * trials + ...
        sqrt(A_var) * trials .* randn(t_length, 1);
    response = (evidence > crit) -1 * (evidence <= crit);
    
    H = 0; M = 0; CR = 0; FA = 0;
    for i = 1:t_length
        if trials(i) == 1
            if response(i) == 1
                H = H + 1;
            else
                M = M + 1;
            end
        else
            if response(i) == -1
                CR = CR + 1;
            else
                FA = FA + 1;
            end
        end
    end
    
    pcorr_simul = (H + CR) * 100/t_length;
    
    Hrate = H/(H+M);
    FArate = FA/(FA+CR);
    if Hrate == 1
        Hrate = 0.9999;
    end
    if FArate == 0
        FArate = 0.0001;
    end
    zH = -sqrt(2) * erfcinv(2*Hrate);
    zFA = -sqrt(2) * erfcinv(2*FArate);
    dp_simul = zH - zFA;
    
    % Theoretical
    resp_range = B_mean-3*B_var: 0.01: A_mean+3*A_var;
    B_cdf = normcdf(resp_range, B_mean, sqrt(B_var));
    A_pdf = normpdf(resp_range, A_mean, sqrt(A_var));
    pcorr_theor = sum(A_pdf .* B_cdf);
    dp_theor = (A_mean - B_mean)/sqrt(A_var);
end

%% Simulation for RT
% The trials in the experiment are simulated as +1 for stimulus A and
% -1 for stimulus B, the probabilities of the stimuli are determined by
% pA, and the length of the experiment is determined by t_length.
% The responses and reaction times are initialized as zeros.

%%
% The time_steps variable stores the number of time_steps each of 100
% ms in which the evidence will be stored. The mean and variance of the
% new distribution is then just a sum of the old distributions over the
% time_steps
%%
% The optimum criterion (x) is computed as in AFC. For each trial, the
% log_posteriors is computed from the log_priors which is log(p(A)/p(B))
% and updated by the evidence at each time-step given by the log-likelihood
% ratio:
%%
% $$Log\ Likelihood\ ratio = log(\frac{p(evidence|A)}{p(evidence|B)}) $$
%%
% The update log posteriors is then: log_posteriors = log_likelihood_ratio
% + log_priors.
%%
% At time step 0, log_posteriors = log_priors = 0 for the case p(A) = p(B).
%%
% The trial runs until the log_posteriors hit either the upper bound or the
% lower bound which determines the response as either +1 (A) or -1 (B).
% The reaction time is the length of log_posteriors - 1.
%%
% The trials and response vectors are then compared to determine the hit
% rate and the false alarm rate.
%% Function to run reaction-time experiment
function [optim_criterion, Hrate, FArate, rtime] = ...
    RT_experiment(dur, contrast, var_dist, pA, t_length, crit, lb, ub)
    trials = rand(t_length, 1);
    trials = (trials>(1-pA)) -1 * (trials<=(1-pA));
    response = zeros(t_length, 1);
    rtime = zeros(t_length, 1);

    % Simulation
    time_steps = dur * 10;
    B_mean = -2 * time_steps * contrast;
    A_mean = 2 * time_steps * contrast;
    B_var = time_steps * var_dist;
    A_var = time_steps * var_dist;
    prior_odds = pA/(1-pA);                                                                                                          
    optim_criterion = A_var/(2*A_mean) * log(1/prior_odds);
    
    if crit == 10000
        crit = optim_criterion;
    end
    
    log_priors = log(prior_odds);
    
    for trial_count = 1:t_length
        trial = trials(trial_count);
        log_posteriors = log_priors;
        while (lb < log_posteriors(end)) & (log_posteriors(end) < ub)
            evidence = 2 * contrast * trial + ...
                trial * randn();
            evidence_A = normpdf(evidence, A_mean, sqrt(A_var));
            evidence_B = normpdf(evidence, B_mean, sqrt(B_var));
            updated_posterior = log_posteriors(end) + ...
                log(evidence_A/evidence_B);
            log_posteriors = [log_posteriors, updated_posterior];
        end
        response(trial_count) = (log_posteriors(end) >= ub) -1 * (log_posteriors(end) <= lb);

        rtime(trial_count) = length(log_posteriors) - 1;
        if trial_count == 10
            figure();
            plot(0:rtime(trial_count), log_posteriors, 'LineWidth', 1.5, ...
                'DisplayName', 'rt')
            hold on;
            plot(xlim, [ub, ub], 'k', 'LineWidth', 2, 'DisplayName', ...
                'upper bound')
            plot(xlim, [lb, lb], 'k', 'LineWidth', 2, 'DisplayName', ...
                'lower bound')
            xlabel('Time steps (100 ms)')
            ylabel('$$log(\frac{p(A|evidence)}{p(B|evidence)})$$', 'Interpreter', 'latex')
            title(['Drift-diffusion model: ', 'contrast: ', num2str(contrast),...
                ' stimulus: ', num2str(trials(trial_count)),...
                ', response: ', num2str(response(trial_count))])
            legend()
        end
    end
    
    H = 0; M = 0; CR = 0; FA = 0;
    for i = 1:t_length
        if trials(i) == 1
            if response(i) == 1
                H = H + 1;
            else
                M = M + 1;
            end
        else
            if response(i) == -1
                CR = CR + 1;
            else
                FA = FA + 1;
            end
        end
    end
       
    Hrate = H/(H+M);
    FArate = FA/(FA+CR);
end

%% Function to create plots
function plot_figs(x, y1, y2, y3, y4, xlab)
    subplot(2, 2, 1)
    plot(x, y1, 'b-o', 'LineWidth', 2, ...
        'MarkerSize', 5)
    xlabel(xlab)
    ylabel('Percentage correct')
    title('Psychometric function simulation')
    subplot(2, 2,2)
    plot(x, y2, 'm-o', 'LineWidth', 2, ...
        'MarkerSize', 5);
    xlabel(xlab)
    ylabel("d'")
    title("d' simulation")

    subplot(2, 2, 3)
    plot(x, y3, 'b-o', 'LineWidth', 2, ...
        'MarkerSize', 5)
    xlabel(xlab)
    ylabel('Percentage correct')
    title('Psychometric function theoretical')
    subplot(2, 2, 4)
    plot(x, y4, 'm-o', 'LineWidth', 2, ...
        'MarkerSize', 5);
    xlabel(xlab)
    ylabel("d'")
    title("d' theoretical")
end
##### SOURCE END #####
--></body></html>